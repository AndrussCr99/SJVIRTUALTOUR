window.widget=window.widget||{};window.widget.content={};window.widget.popWindow={};window.widget.popWindow.tw={};window.widget.popWindow.tw.srcObject=null;window.widget.popWindow.tw.instance=function(a){this.init(a)};window.widget.popWindow.tw.instance.prototype={init:function(e){var a=document.createElement("div");a.addEventListener("selectstart",function(f){f.stopPropagation();f.preventDefault()},false);var c=document.createElement("div");this.cc=c;c.style.position="absolute";c.style.zIndex=1000;c.id=e.id;c.style.overflow="hidden";c.addEventListener("touchmove",function(f){f.stopPropagation();f.preventDefault()},false);this.mc=a;this.popwindowstate="hide";this.relativePosition=e.relativeposition;if(e.height){this.height=e.height}else{this.height=0}if(e.width){this.width=e.width}else{this.width=0}if(e.bgColor){this.bgColor=e.bgColor}if(e.bgImage){this.bgImage=e.bgImage}if(e.opacity){this.opacity=parseFloat(e.opacity)/100}if(e.srcET&&e.srcEL&&e.srcEH&&e.srcEW){this.srcET=parseInt(e.srcET);this.srcEL=parseInt(e.srcEL);this.srcEH=parseInt(e.srcEH);this.srcEW=parseInt(e.srcEW)}this.troggle="hidden";var b=this;this.isrelative=false;c.appendChild(a);if(e.container){e.container.appendChild(c)}this.cc.style.display="none";a.style.zIndex=1;window.widget.content[e.id]=this},refreshContent:function(g){var m=false;var r=null;if(this.height>0&&this.width>0){m=true}else{if(this.properties){if(this.properties.height&&this.properties.width){this.height=parseInt(this.properties.height.end);this.width=parseInt(this.properties.width.end);m=true}if(this.properties.top&&this.properties.left){this.top=parseInt(this.properties.top.end);this.left=parseInt(this.properties.left.end)}}}if(m==false){this.height=0;this.width=0}if(g){var c=this.mc.childNodes;for(var o=0;o<c.length;o++){this.mc.removeChild(c[o--])}for(var o=0;o<g.length;o++){var e=document.createElement("div");e.style.position="absolute";e.style.zIndex=(o+1);var q=g[o];if(q.height&&q.width){e.style.height=parseInt(q.height)+"px";e.style.width=parseInt(q.width)+"px";if(q.top===undefined&&q.left===undefined){q.top=0;q.left=0}e.style.top=q.top+"px";e.style.left=q.left+"px";if(!(m)){var p=parseInt(q.top)+parseInt(q.height);if(parseInt(this.height)<p){this.height=p}var j=parseInt(q.left)+parseInt(q.width);if(parseInt(this.width)<j){this.width=j}}}this.mc.appendChild(e);switch(q.type){case"image":window.img.i[q.id].mc.style.top="0px";window.img.i[q.id].mc.style.left="0px";e.appendChild(window.img.i[q.id].mc);break;case"text":window.text.i[q.id].target.style.top="0px";window.text.i[q.id].target.style.left="0px";e.appendChild(window.text.i[q.id].target);break;case"textarea":window.txa.i[q.id].mc.style.top="0px";window.txa.i[q.id].mc.style.left="0px";e.appendChild(window.txa.i[q.id].mc);break;case"page":e.innerHTML='<iframe frameBorder="no" height="'+q.height+'" width="'+q.width+'" src="'+q.url+'"/>';break;case"widget":e.appendChild(window.widget.content[q.id].cc);break;case"scene":this.hasPano=true;var k=window.twmc;k.style.height=q.height+"px";k.style.width=q.width+"px";k.style.top="0px";k.style.left="0px";e.appendChild(window.twmc);document.getElementById("viewer").style.height=q.height+"px";document.getElementById("viewer").style.width=q.width+"px";var l=document.getElementById("DivProcessBarCover").childNodes[0];r=q;break;case"button":for(var h=0;h<w.tw.popWindowButtons.length;h++){var t=w.tw.popWindowButtons[h];if(q.id==t.id){e.appendChild(t.target)}if(window.c.b.e!="pc"){t.target.removeEventListener("touchend",t.clickFunc,false);t.target.addEventListener("touchend",t.clickFunc,false)}}break;case"video":e.innerHTML='<video src="'+q.url+'" loop="loop" autoplay="autoplay" autobuffer="autobuffer"></video>';break;case"googlemap":e.appendChild(window.m.g.mc);window.m.g.mc.style.top="0px";window.m.g.mc.style.left="0px";this.googlemap=true;setTimeout(w.m.g.display,500);break;case"custommap":e.appendChild(window.m.c.mc);window.m.c.mc.style.top="0px";window.m.c.mc.style.left="0px";this.custommap=true;setTimeout(window.m.c.display,500);break;case"thumbnail":if(window.widget.thumbnail.content[q.id]){var a=window.widget.thumbnail.content[q.id];a.outerContainer.style.top="0px";a.outerContainer.style.left="0px";e.appendChild(a.outerContainer)}break}}if(this.bgColor){this.cc.style.backgroundColor=this.bgColor}if(this.bgImage){if(this.bgColor){this.cc.style.background="url('"+this.bgImage+"') no-repeat center center "+this.bgColor+""}else{this.cc.style.background="url('"+this.bgImage+"') no-repeat center center"}}else{if(this.bgColor){this.cc.style.backgroundColor=this.bgColor}}if(this.opacity){this.properties.opacity={end:parseFloat(this.opacity),unit:""}}else{this.properties.opacity={end:1,unit:""}}this.properties.height.unit="px";this.properties.width.unit="px";this.properties.top=this.properties.top||{};this.properties.top.unit="px";this.properties.left=this.properties.left||{};this.properties.left.unit="px";if(this.position==0){if(this.isrelative==false){this.isrelative=true}if(window.twmode=="fullscreen"){if(this.relativePosition){switch(this.relativePosition){case 1:this.properties.top.end=(0+parseInt(this.oTop));this.properties.left.end=(0+parseInt(this.oLeft));break;case 2:this.properties.top.end=(0+parseInt(this.oTop));this.properties.left.end=(Math.round(d[a4][a9]/2)+parseInt(this.oLeft));break;case 3:this.properties.top.end=(0+parseInt(this.oTop));this.properties.left.end=(d[a4][a9]+parseInt(this.oLeft));break;case 4:this.properties.top.end=(Math.round(d[a4][a8]/2)+parseInt(this.oTop));this.properties.left.end=(0+parseInt(this.oLeft));break;case 5:this.properties.top.end=(Math.round(d[a4][a8]/2)+parseInt(this.oTop));this.properties.left.end=(Math.round(d[a4][a9]/2)+parseInt(this.oLeft));break;case 6:this.properties.top.end=(Math.round(d[a4][a8]/2)+parseInt(this.oTop));this.properties.left.end=(d[a4][a9]+parseInt(this.oLeft));break;case 7:this.properties.top.end=(d[a4][a8]+parseInt(this.oTop));this.properties.left.end=(0+parseInt(this.oLeft));break;case 8:this.properties.top.end=(d[a4][a8]+parseInt(this.oTop));this.properties.left.end=(Math.round(d[a4][a9]/2)+parseInt(this.oLeft));break;case 9:this.properties.top.end=(d[a4][a8]+parseInt(this.oTop));this.properties.left.end=(d[a4][a9]+parseInt(this.oLeft));break}}}}else{if(this.position==-1){if(this.height>this.srcET){this.properties.top.end=this.srcET+this.srcEH;if(this.width>this.srcEL){this.properties.left.end=this.srcEL+this.srcEW}else{this.properties.left.end=this.srcEL-this.width}}else{this.properties.top.end=this.srcET-this.height;if(this.width>this.srcEL){this.properties.left.end=this.srcEL+this.srcEW}else{this.properties.left.end=this.srcEL-this.width}}}else{var b=Math.round((document.documentElement.clientHeight-this.height)/2);var f=Math.round((document.documentElement.clientWidth-this.width)/2);var s=document.documentElement.clientWidth-this.width;var n=document.documentElement.clientHeight-this.height;switch(this.position){case 1:this.properties.top.end=0;this.properties.left.end=0;break;case 2:this.properties.top.end=0;this.properties.left.end=f;break;case 3:this.properties.top.end=0;this.properties.left.end=s;break;case 4:this.properties.top.end=b;this.properties.left.end=0;break;case 5:this.properties.top.end=b;this.properties.left.end=f;break;case 6:this.properties.top.end=b;this.properties.left.end=s;break;case 7:this.properties.top.end=n;this.properties.left.end=0;break;case 8:this.properties.top.end=n;this.properties.left.end=f;break;case 9:this.properties.top.end=n;this.properties.left.end=s;break}}}if(this.fxtype){if(this.fxtype==1){this.properties.opacity.start=0;this.properties.top.start=this.properties.top.end;this.properties.left.start=this.properties.left.end;this.properties.height.start=this.properties.height.end;this.properties.width.start=this.properties.width.end}else{if(this.fxtype==2){this.properties.top.start=this.properties.top.end;this.properties.left.start=this.properties.left.end;this.properties.opacity.start=this.properties.opacity.end;switch(this.fxeffect){case 1:this.properties.top.start=this.properties.top.end;this.properties.left.start=this.properties.left.end;this.properties.height.start=0;this.properties.width.start=0;break;case 2:this.properties.top.start=this.properties.top.end;this.properties.left.start=this.properties.left.end;this.properties.height.start=0;this.properties.width.start=this.properties.width.end;break;case 3:this.properties.top.start=this.properties.top.end;this.properties.left.start=document.documentElement.clientWidth-this.width;this.properties.height.start=0;this.properties.width.start=0;break;case 4:this.properties.top.start=this.properties.top.end;this.properties.left.start=this.properties.left.end;this.properties.height.start=this.properties.height.end;this.properties.width.start=0;break;case 5:this.properties.top.start=this.properties.top.end;this.properties.left.start=document.documentElement.clientWidth;this.properties.height.start=this.properties.height.end;this.properties.width.start=0;break;case 6:this.properties.top.start=document.documentElement.clientHeight;this.properties.left.start=this.properties.left.end;this.properties.height.start=0;this.properties.width.start=0;break;case 7:this.properties.top.start=document.documentElement.clientHeight;this.properties.left.start=this.properties.left.end;this.properties.height.start=0;this.properties.width.start=this.properties.width.end;break;case 8:this.properties.top.start=document.documentElement.clientHeight;this.properties.left.start=document.documentElement.clientWidth;this.properties.height.start=0;this.properties.width.start=0;break}}else{if(this.fxtype==3){this.properties.opacity.start=this.properties.opacity.end;this.properties.height.start=this.properties.height.end;this.properties.width.start=this.properties.width.end;var b=Math.round((document.documentElement.clientHeight-this.height)/2);var f=Math.round((document.documentElement.clientWidth-this.width)/2);var s=document.documentElement.clientWidth-this.width;var n=document.documentElement.clientHeight-this.height;switch(this.fxeffect){case 1:this.properties.top.start=0-this.height;this.properties.left.start=0-this.width;break;case 2:this.properties.top.start=0-this.height;this.properties.left.start=this.properties.left.end;break;case 3:this.properties.top.start=0-this.height;this.properties.left.start=s+this.width;break;case 4:this.properties.top.start=this.properties.top.end;this.properties.left.start=0-this.width;break;case 5:this.properties.top.start=this.properties.top.end;this.properties.left.start=s+this.width;break;case 6:this.properties.top.start=n+this.height;this.properties.left.start=0-this.width;break;case 7:this.properties.top.start=n+this.height;this.properties.left.start=this.properties.left.end;break;case 8:this.properties.top.start=n+this.height;this.properties.left.start=s+this.wodth;break}}}}}else{this.properties.top.start=this.properties.top.end;this.properties.left.start=this.properties.left.end;this.properties.height.start=this.properties.height.end;this.properties.width.start=this.properties.width.end;this.properties.opacity.start=this.properties.opacity.end}this.popwindowstate="display";if(r){this.__displayAnimate({target:this.cc,duration:this.duration,properties:this.properties,sv:r})}else{this.__displayAnimate({target:this.cc,duration:this.duration,properties:this.properties})}}},displayOrHideFunc:function(g,b,a,f,e,c){if(this.troggle=="hidden"){if(this.__isAnimate){this.troggle="display";this.displayFunc(g,b,a,f,e,c)}}else{if(this.__isAnimate){this.troggle="hidden";this.hideAminateFunc(f,this.duration,0)}}},displayFunc:function(j,c,a,i,h,g){this.position=a;this.fxtype=i;this.fxeffect=h;this.duration=g;if(this.duration===undefined||isNaN(this.duration)){this.duration=500}else{this.duration=this.duration/4}if((typeof(c))=="string"){this.troggle="display"}else{if(window.widget.popWindow.tw.srcObject==c){}else{window.widget.popWindow.tw.srcObject=c}if(c.srcElement){var b=window.c.f(c.srcElement);this.srcET=b.top;this.srcEL=b.left;this.srcEH=c.srcElement.clientHeight;this.srcEW=c.srcElement.clientWidth}else{var f=window.event;if(f){this.srcEH=50;this.srcEW=50;if(window.c.b.e=="pc"){this.srcET=(f.pageY-25);this.srcEL=(f.pageX-25)}else{this.srcET=(f.changedTouches[0].pageY-25);this.srcEW=(f.changedTouches[0].pageX-25)}}else{this.srcEH=0;this.srcEW=0;this.srcET=0;this.srcEL=0}}}if(window.twmc){window.twmc.style.display="block"}this.isDisplay=true;this.cc.style.zIndex=10001;this.cc.style.display="block";if(j.properties){this.properties=j.properties}if(j.content){this.refreshContent(j.content)}},hideAminateFunc:function(c,b,a){if(b===undefined||isNaN(b)){b=500}else{b=b/4}if(this.popwindowstate=="display"){if(this.troggle=="display"){this.troggle="hidden"}var e={};for(__ in this.properties){e[__]={};e[__].start=parseInt(this.properties[__].end);e[__].end=parseInt(this.properties[__].start);e[__].unit=this.properties[__].unit;if(__=="opacity"){if(e[__].start==0){e[__].start=1}}}if(c){if(c==1){e.opacity.end=0}else{if(c==2){switch(a){case 1:e.height.end=0;e.width.end=0;break;case 2:e.height.end=0;break;case 3:e.height.end=0;e.width.end=0;e.left.end=e.left.start-this.width;break;case 4:e.width.end=0;break;case 5:e.width.end=0;e.left.end=e.left.start+this.width;break;case 6:e.height.end=0;e.width.end=0;e.top.end=e.top.start+this.height;break;case 7:e.height.end=0;e.top.end=e.top.start+this.height;break;case 8:e.height.end=0;e.width.end=0;e.left.end=e.left.start+this.width;e.top.end=e.top.start+this.height;break}}else{if(c==3){switch(a){case 1:e.top.end=0-this.height;e.left.end=0-this.width;break;case 2:e.top.end=0-this.height;e.left.end=e.left.start;break;case 3:e.top.end=0-this.height;e.left.end=document.documentElement.clientWidth;break;case 4:e.top.end=e.top.start;e.left.end=0-this.width;break;case 5:e.top.end=e.top.start;e.left.end=document.documentElement.clientWidth;break;case 6:e.top.end=document.documentElement.clientHeight;e.left.end=0+this.height;break;case 7:e.top.end=document.documentElement.clientHeight;e.left.end=e.left.start;break;case 8:e.top.end=document.documentElement.clientHeight;e.left.end=document.documentElement.clientWidth;break}}}}this.popwindowstate="hide";this.__displayAnimate({target:this.cc,duration:b,properties:e})}else{this.hideFunc()}}},hideFunc:function(){this.isDisplay=false;this.cc.style.zIndex=1;this.cc.style.display="none";if(this.hasPano){window.tw.clearPlayer()}if(this.googlemap){window.m.g.hide()}if(this.custommap){window.m.c.hide()}},adujustPosition:function(b,a){if(this.top&&this.left){}else{this.cc.style.top=Math.round((b-this.cc.clientHeight)/2)+"px";this.cc.style.left=Math.round((a-this.cc.clientWidth)/2)+"px"}},__isAnimate:true,__animateHandler:null,__animateTarget:null,__animateProperties:{},__displayAnimate:function(e){if(this.__isAnimate){this.___animateTarget=e.target;this.__animateProperties={};for(__ in e.properties){var c={};var b=e.properties[__];if(b.unit===undefined){c.unit=""}else{c.unit=b.unit}var a=parseFloat(document.defaultView.getComputedStyle(e.target,false)[__]);if(b.end=="auto"){if(isNaN(a)){b.end=undefined}else{b.end=a}}if(b.start=="auto"){if(isNaN(a)){b.start=undefined}else{b.start=a}}if(b.start!==undefined){if(e.duration>0){c.step=(parseFloat(b.end)-parseFloat(b.start))/(parseInt(e.duration)/20)}else{c.step=0}c.start=b.start;c.realValue=b.start;e.target.style[__]=b.start+""+b.unit}else{c.step=0;e.target.style[__]=b.end+""+b.unit}c.end=b.end;c.isAnimate=true;this.__animateProperties[__]=c}if(e.duration>0){this.__isAnimate=false}this.__displayAnimateFunc(e.sv)}},__displayAnimateFunc:function(b){var a=this.__animateProperties;for(__ in a){if(a[__].isAnimate){if(a[__].step){if(a[__].step>0){if((a[__].realValue+a[__].step)>a[__].end){a[__].isAnimate=false;a[__].realValue=a[__].end}else{a[__].realValue=(a[__].realValue+a[__].step)}}else{if((a[__].realValue+a[__].step)<a[__].end){a[__].isAnimate=false;a[__].realValue=a[__].end}else{a[__].realValue=(a[__].realValue+a[__].step)}}this.___animateTarget.style[__]=a[__].realValue+""+a[__].unit}else{a[__].isAnimate=false;this.___animateTarget.style[__]=a[__].end+""+a[__].unit}}}var e=false;for(__ in a){if(a[__].isAnimate){e=true;break}}if(e==false){this.__isAnimate=true;if(this.popwindowstate=="hide"){this.hideFunc()}if(b){w.tw.changeScene(b,this)}}else{var c=this;if(this.__animateHandler){clearTimeout(this.__animateHandler)}this.__animateHandler=setTimeout(function(){return c.__displayAnimateFunc.apply(c,[b])},20)}},__stopAnimateFunc:function(c){if(this.__isAnimate===false){var a=this.__animateProperties;var b=this.___animateTarget;clearTimeout(this.__animateHandler);this.__animateHandler=null;this.__isAnimate=true;for(__ in a){if(c&&c=="clear"){b.style[__]=a[__].end+""+a[__].unit}else{b.style[__]=a[__].start+""+a[__].unit}}}}};window.widget.popWindow.changeSize=function(){window.widget.popWindow.changeOriental()};window.widget.popWindow.changeOriental=function(){for(__ in w.widget.content){var a=w.widget.content[__];if(a.position){if(a.position>0){var f=Math.round((document.documentElement.clientHeight-a.height)/2);var c=Math.round((document.documentElement.clientWidth-a.width)/2);var b=document.documentElement.clientWidth-a.width;var e=document.documentElement.clientHeight-a.height;switch(a.position){case 1:a.properties.top.end=0;a.properties.top.left=0;a.cc.style.top="0px";a.cc.style.left="0px";break;case 2:a.properties.top.end=0;a.properties.top.left=c;a.cc.style.top=0+"px";a.cc.style.left=c+"px";break;case 3:a.properties.top.end=0;a.properties.top.left=b;a.cc.style.top=0+"px";a.cc.style.left=b+"px";break;case 4:a.properties.top.end=f;a.properties.top.left=0;a.cc.style.top=f+"px";a.cc.style.left=0+"px";break;case 5:a.properties.top.end=f;a.properties.top.left=c;a.cc.style.top=f+"px";a.cc.style.left=c+"px";break;case 6:a.properties.top.end=f;a.properties.top.left=b;a.cc.style.top=f+"px";a.cc.style.left=b+"px";break;case 7:a.properties.top.end=e;a.properties.top.left=0;a.cc.style.top=e+"px";a.cc.style.left=0+"px";break;case 8:a.properties.top.end=e;a.properties.top.left=c;a.cc.style.top=e+"px";a.cc.style.left=c+"px";break;case 9:a.properties.top.end=e;a.properties.top.left=b;a.cc.style.top=e+"px";a.cc.style.left=b+"px";break}}else{a.cc.style.top=a.properties.top.end+"px";a.cc.style.left=a.properties.left.end+"px"}}else{if(a.properties){switch(a.relativePosition){case 1:a.properties.top.end=(0+parseInt(a.oTop));a.properties.left.end=(0+parseInt(a.oLeft));a.cc.style.top=(0+parseInt(a.oTop))+"px";a.cc.style.left=(0+parseInt(a.oLeft))+"px";break;case 2:a.properties.top.end=(0+parseInt(a.oTop));a.properties.left.end=(Math.round(d[a4][a9]/2)+parseInt(a.oLeft));a.cc.style.top=(0+parseInt(a.oTop))+"px";a.cc.style.left=(Math.round(d[a4][a9]/2)+parseInt(a.oLeft))+"px";break;case 3:a.properties.top.end=(0+parseInt(a.oTop));a.properties.left.end=(d[a4][a9]+parseInt(a.oLeft));a.cc.style.top=(0+parseInt(a.oTop))+"px";a.cc.style.left=(d[a4][a9]+parseInt(a.oLeft))+"px";break;case 4:a.properties.top.end=(Math.round(d[a4][a8]/2)+parseInt(a.oTop));a.properties.left.end=(0+parseInt(a.oLeft));a.cc.style.top=(Math.round(d[a4][a8]/2)+parseInt(a.oTop))+"px";a.cc.style.left=(0+parseInt(a.oLeft))+"px";break;case 5:a.properties.top.end=(Math.round(d[a4][a8]/2)+parseInt(a.oTop));a.properties.left.end=(Math.round(d[a4][a9]/2)+parseInt(a.oLeft));a.cc.style.top=(Math.round(d[a4][a8]/2)+parseInt(a.oTop))+"px";a.cc.style.left=(Math.round(d[a4][a9]/2)+parseInt(a.oLeft))+"px";break;case 6:a.properties.top.end=(Math.round(d[a4][a8]/2)+parseInt(a.oTop));a.properties.left.end=(d[a4][a9]+parseInt(a.oLeft));a.cc.style.top=(Math.round(d[a4][a8]/2)+parseInt(a.oTop))+"px";a.cc.style.left=(d[a4][a9]+parseInt(a.oLeft))+"px";break;case 7:a.properties.top.end=(d[a4][a8]+parseInt(a.oTop));a.properties.left.end=(0+parseInt(a.oLeft));a.cc.style.top=(d[a4][a8]+parseInt(a.oTop))+"px";a.cc.style.left=(0+parseInt(a.oLeft))+"px";break;case 8:a.properties.top.end=(d[a4][a8]+parseInt(a.oTop));a.properties.left.end=(Math.round(d[a4][a9]/2)+parseInt(a.oLeft));a.cc.style.top=(d[a4][a8]+parseInt(a.oTop))+"px";a.cc.style.left=(Math.round(d[a4][a9]/2)+parseInt(a.oLeft))+"px";break;case 9:a.properties.top.end=(d[a4][a8]+parseInt(a.oTop));a.properties.left.end=(d[a4][a9]+parseInt(a.oLeft));a.cc.style.top=(d[a4][a8]+parseInt(a.oTop))+"px";a.cc.style.left=(d[a4][a9]+parseInt(a.oLeft))+"px";break}}}}};window.addEventListener("resize",window.widget.popWindow.changeSize,false);window.addEventListener("orientationchange",window.widget.popWindow.changeOriental,false);